<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sección de Alimentos Mejorada</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <p id="mensaje" style="display: none;">Esperando mensaje del backend...</p>

  <header class="header-alimentos">
    <h1><span>TOTTUS</span></h1>

    <div class="zona-superior-derecha">
      <div class="barra-busqueda-principal">
        <input type="text" placeholder="Buscar alimentos..." />
        <button>Buscar</button>
      </div>

      <div class="contenedor-carrito">
        <a href="carrito.html" class="boton-carrito">🛒 Carrito</a>
      </div>
    </div>
  </header>

  <div class="contenedor-navegacion">
    <nav class="navegacion-alimentos">
      <ul>
        <li><a href="frutas.html">Frutas</a></li>
        <li><a href="verduras.html">Verduras</a></li>
        <li><a href="abarrotes.html">Abarrotes</a></li>
        <li><a href="carnes.html">Carnes</a></li>
        <li><a href="lacteos.html">Lácteos</a></li>
        <li><a href="panaderia.html">Panadería</a></li>
        <li><a href="pasteleria.html">Pastelería</a></li>
        <li><a href="bebidas.html">Bebidas</a></li>
      </ul>
    </nav>

    <!-- Banner  -->
    <section class="banner-slider">
      <div class="slide active">
        <img src="imagenes/banner1.jpg.webp" alt="Promoción 1" />
      </div>
      <div class="slide">
        <img src="imagenes/banner2.jpg.webp" alt="Promoción 2" />
      </div>
      <div class="slide">
        <img src="imagenes/banner3.jpg.webp" alt="Promoción 3" />
      </div>
      <div class="slide">
        <img src="imagenes/banner4.jpg.webp" alt="Promoción 4" />
      </div>
      <div class="slide">
        <img src="imagenes/banner5.jpg.webp" alt="Promoción 5" />
      </div>
      <div class="slide">
        <img src="imagenes/banner6.jpg.webp" alt="Promoción 6" />
      </div>
      <button class="prev">&#10094;</button>
      <button class="next">&#10095;</button>
    </section>

    <section class="productos-destacados">
      <h2>Destacados de la Semana</h2>
      <div class="lista-productos">
        <div class="producto">
          <img src="imagenes/pasteleria43.png" alt="Turrón de Doña Pepa 500g" />
          <h3>Turrón de Doña Pepa 500g</h3>
          <p class="precio">S/ 11.90 / UN</p>
          <button class="boton-comprar">Agregar al carrito</button>
        </div>
        <div class="producto">
          <img src="imagenes/panaderia35.png" alt="Mini tostadas integrales x 110g" />
          <h3>Mini tostadas integrales x 110g</h3>
          <p class="precio">S/ 6.90 / UN</p>
          <button class="boton-comprar">Agregar al carrito</button>
        </div>
        <div class="producto">
          <img src="imagenes/carne60.png" alt="Chorizo parrillero 500g" />
          <h3>Chorizo parrillero 500g</h3>
          <p class="precio">S/ 17.50 / UN</p>
          <button class="boton-comprar">Agregar al carrito</button>
        </div>
        <div class="producto">
          <img src="imagenes/bebidas53.png" alt="Red Bull energizante sin azucar 250 mL" />
          <h3>Red Bull sin azúcar 250 mL</h3>
          <p class="precio">S/ 7.90 / UN</p>
          <button class="boton-comprar">Agregar al carrito</button>
        </div>
        <div class="producto">
          <img src="imagenes/abarrote47.png" alt="Sólido de Atún en Aceite 140g" />
          <h3>Sólido de Atún en Aceite 140g</h3>
          <p class="precio">S/ 5.80 / UN</p>
          <button class="boton-comprar">Agregar al carrito</button>
        </div>
        <div class="producto">
          <img src="imagenes/abarrote38.png" alt="Aceite de Soya 900 mL" />
          <h3>Aceite de Soya 900 mL</h3>
          <p class="precio">S/ 6.10 / UN</p>
          <button class="boton-comprar">Agregar al carrito</button>
        </div>
        <div class="producto">
          <img src="imagenes/bebidas33.png" alt="Agua 2.5L six pack" />
          <h3>Agua 2.5L six pack</h3>
          <p class="precio">S/ 16.20 / UN</p>
          <button class="boton-comprar">Agregar al carrito</button>
        </div>
      </div>
    </section>

    <!-- Zona de descuentos visuales -->
    <section class="zona-descuentos">
      <h2>Ofertas del Momento</h2>
      <div class="descuentos-grid">
        <div class="descuento-item">
          <img src="imagenes/descuento1.jpg.webp" alt="Descuento 1" />
        </div>
        <div class="descuento-item">
          <img src="imagenes/descuento2.jpg.webp" alt="Descuento 2" />
        </div>
        <div class="descuento-item">
          <img src="imagenes/descuento3.jpg.webp" alt="Descuento 3" />
        </div>
        <div class="descuento-item">
          <img src="imagenes/descuento4.jpg.webp" alt="Descuento 4" />
        </div>
      </div>
    </section>

    <footer class="footer-alimentos">
      <div class="footer-social">
        <a href="https://www.facebook.com/TottusPeru" target="_blank"><img src="imagenes/facebook.png" alt="Facebook" /></a>
        <a href="https://www.instagram.com/tottusperu/" target="_blank"><img src="imagenes/instagram.png" alt="Instagram" /></a>
        <a href="https://www.youtube.com/@TottusPeru" target="_blank"><img src="imagenes/youtube.png" alt="YouTube" /></a>
      </div>
      <div class="footer-links">
        <a href="https://assets.contentstack.io/v3/assets/blt422ac29cebae1d64/blt3dabc5c40faa057e/67db3e1e1c722200f543b13d/TC_Web_y_App_v3_18.03.25_vf.pdf"
          >Términos y condiciones</a
        >
        <a href="https://assets.contentstack.io/v3/assets/blt422ac29cebae1d64/bltb0dcce37212d19b6/680a53d983ae052f59e06575/Politica_de_Cookies_Tottus_Peru%CC%81_2025_4931-0316-7279_v.1.pdf"
          >Política de cookies</a
        >
        <a href="https://www.tottus.com.pe/tottus-pe/content/politica-de-privacidad">Política de privacidad</a>
      </div>
      <div class="footer-separator"></div>
      <div class="footer-copyright">
        <p>&copy; TODOS LOS DERECHOS RESERVADOS</p>
        <p>Av. Angamos Este N° 1805 Piso 10, Surquillo, Lima, Perú.</p>
      </div>
    </footer>
  </div>

  <!-- Aquí podemos agregar elementos para mostrar el carrito, si quieres verlo en esta página -->
  <ul id="lista-carrito" style="list-style: none; padding: 0; max-width: 400px; margin: 20px auto;"></ul>
  <p id="total-carrito" style="text-align: center; font-weight: bold;"></p>
  <p id="carrito-vacio" style="text-align: center; display: none; font-style: italic;">El carrito está vacío.</p>

  <div id="alerta-carrito" style="
    position: fixed;
    bottom: 30px;
    left: 50%;
    transform: translateX(-50%);
    background-color: #6CA600;
    color: white;
    padding: 10px 20px;
    border-radius: 6px;
    font-weight: bold;
    display: none;
    z-index: 1000;
    box-shadow: 0 2px 8px rgba(0,0,0,0.3);
  ">
    Se agregó al carrito.
  </div>

  <!-- Scripts -->
  <script>
    // Código del slider
    document.addEventListener("DOMContentLoaded", function () {
      const slides = document.querySelectorAll('.slide');
      const prevBtn = document.querySelector('.prev');
      const nextBtn = document.querySelector('.next');
      let currentIndex = 0;

      function showSlide(index) {
        slides.forEach(slide => slide.classList.remove('active'));
        slides[index].classList.add('active');
      }

      prevBtn.addEventListener('click', () => {
        currentIndex = (currentIndex === 0) ? slides.length - 1 : currentIndex - 1;
        showSlide(currentIndex);
      });

      nextBtn.addEventListener('click', () => {
        currentIndex = (currentIndex === slides.length - 1) ? 0 : currentIndex + 1;
        showSlide(currentIndex);
      });
    });

    // Carrito básico
    const botonesComprar = document.querySelectorAll('.boton-comprar');
    const listaCarrito = document.getElementById('lista-carrito');
    const totalCarrito = document.getElementById('total-carrito');
    const carritoVacio = document.getElementById('carrito-vacio');
    const alertaCarrito = document.getElementById('alerta-carrito');

    let carrito = [];

    function actualizarCarrito() {
      listaCarrito.innerHTML = '';
      let total = 0;
      if (carrito.length === 0) {
        carritoVacio.style.display = 'block';
        totalCarrito.textContent = '';
      } else {
        carritoVacio.style.display = 'none';
        carrito.forEach(item => {
          const li = document.createElement('li');
          li.textContent = `${item.nombre} - S/ ${item.precio.toFixed(2)} x ${item.cantidad}`;
          listaCarrito.appendChild(li);
          total += item.precio * item.cantidad;
        });
        totalCarrito.textContent = `Total: S/ ${total.toFixed(2)}`;
      }
    }

    function mostrarAlerta() {
      alertaCarrito.style.display = 'block';
      setTimeout(() => {
        alertaCarrito.style.display = 'none';
      }, 2000);
    }

    botonesComprar.forEach((boton, index) => {
      boton.addEventListener('click', () => {
        const productoElem = boton.parentElement;
        const nombre = productoElem.querySelector('h3').textContent;
        const precioTexto = productoElem.querySelector('.precio').textContent;
        const precio = parseFloat(precioTexto.replace(/[^\d.,]/g, '').replace(',', '.'));
        const existente = carrito.find(p => p.nombre === nombre);
        if (existente) {
          existente.cantidad++;
        } else {
          carrito.push({ nombre, precio, cantidad: 1 });
        }
        actualizarCarrito();
        mostrarAlerta();
      });
    });

    // Obtener mensaje del backend y mostrarlo
    async function cargarMensaje() {
      const pMensaje = document.getElementById('mensaje');
      try {
        const respuesta = await fetch('/api/mensaje');
        if (!respuesta.ok) throw new Error('Error en la respuesta');
        const data = await respuesta.json();
        if (data.mensaje) {
          pMensaje.textContent = data.mensaje;
          pMensaje.style.display = 'block';
        } else {
          pMensaje.textContent = 'No se encontró ningún mensaje.';
          pMensaje.style.display = 'block';
        }
      } catch (error) {
        pMensaje.textContent = 'No se pudo obtener el mensaje del backend.';
        pMensaje.style.display = 'block';
        console.error(error);
      }
    }

    cargarMensaje();
  </script>
</body>

</html>
